<html>
	<head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
		<title></title>
        <link rel="stylesheet" href="normalize.css">
        <style>
            .next {
                position: absolute;
                bottom: 0;
                left: 0;
                right: 0;
                width: 100%;
                border-style: none;
                font-size: 18px;
                padding: 12px;
            }

            .next:hover {
                background-color: #ccc;
                cursor: pointer;
            }

            #percentage {
                font-size: 100px;
                position: absolute;
                top: 50%;
                left: 50%;
                margin-top: -100px;
                margin-left: -77px;
                text-align: center;
            }

            #emoji {
                font-size: 100px;
                position: absolute;
                top: 50%;
                left: 50%;
                margin-left: -50px;
                text-align: center;
            }
        </style>
	</head>
	<body>

    <button class="next" id="next">Next</button>

    <div id="emoji"></div>
    <div id="percentage">0%</div>

    <script src="http://localhost:3000/socket.io/socket.io.js"></script>
    <script>
        var numCorrectAnswers = 0;
        var numPlayers = 0;

        function correctAnswerReceived() {
            numCorrectAnswers++;
            var percentage = Math.round(getPercentageCorrect());
            document.getElementById('percentage').innerHTML = percentage + '%';

            var emoji;

            if (percentage > 90) {
                emoji = "üòÉ";
            } else if (percentage > 75) {
                emoji = "üòÑ";
            } else if (percentage > 50) {
                emoji = "üòä";
            } else if (percentage > 25) {
                emoji = "üòê";
            } else {
                emoji = "üò´";
            }

            document.getElementById('emoji').innerHTML = emoji;
        }

        function questionStarted(data) {
            numCorrectAnswers = 0;
            numPlayers = data.playerCount;
            console.log('question started with', numPlayers, 'players');
        }

        function getPercentageCorrect() {
            return (numCorrectAnswers / numPlayers) * 100;
        }

    	var io = io('http://127.0.0.1:3000');
    	var button = document.getElementById('next');
        // var button2 = document.getElementById('show');

        button.addEventListener('click', function() {
            io.emit('next');
        });
        // button2.addEventListener('click', function() {
        //     io.emit('showImage');
        // });

        io.emit('connectHost');

        io.on('correctAnswerReceived', correctAnswerReceived);

        io.on('questionStarted', questionStarted);
    </script>
	</body>
</html>